name: Deploy Flutter Web to GitHub Pages

on:
  push:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
<<<<<<< HEAD
          flutter-version: '3.41.1' # æŒ‡å®šç¨³å®šç‰ˆæœ¬
=======
          flutter-version: '3.19.0'  # ğŸ‘ˆ å¼ºåˆ¶æŒ‡å®š 3.19.0
>>>>>>> 58d9bbd (ci: force flutter 3.19.0 and downgrade deps)
          channel: 'stable'
          cache: true                # å¼€å¯ç¼“å­˜åŠ é€Ÿ
          cache-key: "flutter-3.19.0" # ğŸ‘ˆ å¼ºåˆ¶ç¼“å­˜é”®ï¼Œé¿å…æ··ç”¨

      - name: Install Dependencies
        run: |
          cd apps/web
          flutter pub get

      - name: Build Web
        run: |
          cd apps/web
<<<<<<< HEAD
          # å…³é”®ï¼šåŠ ä¸Š --base-hrefï¼Œå› ä¸º GitHub Pages æ˜¯å­è·¯å¾„
          flutter build web --release --base-href "/purelink/"
=======
          # ğŸ‘‡ ä½¿ç”¨ html æ¸²æŸ“å™¨ï¼Œå…¼å®¹æ€§æœ€å¥½
          flutter build web --release --web-renderer html --base-href "/purelink/"
>>>>>>> 58d9bbd (ci: force flutter 3.19.0 and downgrade deps)

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./apps/web/build/web
